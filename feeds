#!/usr/bin/env node
const program = require('commander')
const package = require('./package.json')

program
  .version(package.version, '-v, --version')

program
  .command('migrate <where>')
  .action((where, args) => {
    const migrate = require('./lib/migrate')
    migrate.connect()
    if (where === 'up') {
      migrate.up()
    } else if (where == 'down') {
      migrate.down()
    } else {
      console.error(`Migration can only be run up or down, "${where}" is invalid`)      
    }
  })

program
  .command('worker <which>')
  .action((which, args) => {
    console.log(`Running worker ${which}`)
  })

program.parse(process.argv)

if (process.argv.length == 2) {
  console.log(`Running app`)
  const app = require('./lib/server')
}